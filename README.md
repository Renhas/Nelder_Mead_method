# Метод Нелдера-Мида
## Описание
Метод Нелдера-Мида (метод деформирующего многогранника, симплекс метод) - метод безусловной оптимизации функции от нескольких переменных. Главным преимуществом является то, что метод не использует градиентов функции и потому применим к негладким функциям. Данный метод является итерационным. Суть метода заключается в деформировании симплекса и поступательном приближении к минимуму функции. Потому, результат метода зависит от выбора начального симплекса. Стоит также учитывать, что метод может "застрять" в одном из локальных минимумом, что решается выбором другого симплекса. 
## Реализация метода
### Параметры
- `alpha` - коэффициент отражения, обычно равен 1
- `betta` - коэффициент сжатия, обычно равен 0.5
- `gamma` - коэффициент растяжения, обычно равен 2
### Алгоритм метода
Метод Нелдера-Мида может быть реализован разными способами. В данной реализации был выбран алгоритм, описанный [здесь](https://ru.wikipedia.org/wiki/Метод_Нелдера_—_Мида). Операции отражения, сжатия и растяжения (включая последующие проверки) были вынесены в отдельные функции. В качестве условия останова было выбрано ограничение по итерациям (циклам) алгоритма, а также "ранние" условия останова:
- по взаимной близости точек (когда дисперсия меньше заданного значения `eps0`)
- по количеству "бесполезных" итераций подряд (когда абсолютная разница между найденным значением функции и предыдущим меньше заданного `eps1`)
### Использование метода
1. Создание экземпляра класса с необходимыми параметрами метода.
```python
method = NelderMead()
```
Или 
```python
method = NelderMead(alpha=1.5, max_steps=2000, eps0=10**(-6))
```
2. Инициализация оптимизируемой функции и задание начального симплекса (опционально)
```python
function = Rosenbroke()
method.fit(function, [[10, 3], [2, 4], [3, 5]])
```
Или 
```python
function = Himmelblau()
method.fit(function)
```
3. Запуск метода. Опционально можно передать функцию, которая будет срабатывать в конце каждой итерации
```python
result = method.Run()
```
Или 
```python
result = method.Run(action=lambda x: print(x))
```
Или
```python
def foo(m):
  print(m.simplex)

result = method.Run(action=foo)
```
# Структура файлов
## `gifs` - папка с gif-файлами иллюстрации работы метода
## `Tests` - папка с pytest-тестами
Тестируют классы из модуля `functions.py` и `neldermead.py`
## `functions.py` - модуль с классами функций, передаваемых в метод Нелдера-Мида
`BaseFunction` - базовый класс, хранящий произвольнон символьное выражение и набор символов-переменных. Предоставляет стандартный интерфейс для других классов

`Polynomial` - класс для более удобного формирования многомерных полиномов

`Rosenbroke` - класс с функцией Розенброка (двумерной)

`Himmelblau` - класс с функцией Химмельблау

Для использования своих собственных функций, необходимо либо создавать экземпляр `BaseFunction`, передавая туда выражение, либо определять класс-наследник от `BaseFunction`
## `nelder_mead.py` - модуль с классом, реализующим метод Нелдера-Мида
## `main.py` - модуль с демонстрацией работы с модулями
В приведённом примере создаётся анимация изменения симплекса функции Розенброка с каждой итерацией. Красной точкой на графике отображается точка минимума.

<picture>
  <source media="(prefers-color-scheme: dark)" srcset="gifs/animation_100_dark.gif">
  <source media="(prefers-color-scheme: light)" srcset="gifs/animation_100.gif">
  <img alt="Изменение симплекса функции Розенброка за 100 шагов" src="gifs/animation_100.gif">
</picture>
